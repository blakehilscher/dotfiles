#!/usr/bin/env ruby
# encoding: UTF-8

command = ARGV[0]

def bash(c)
  puts c
  `#{c}`
end 

def url_for_command(command)
  git_url = `git config --get remote.origin.url`
  branch = `git branch | grep '*'`.gsub('* ','').strip.rstrip
  url = git_url.split(':').last.gsub('.git','').strip.rstrip
  
  case command.to_s.to_sym
  when :pr        then "http://github.com/#{url}/compare/#{branch}?expand=1"
  when :p     then "http://github.com/#{url}/pulls"
  when :i     then "http://github.com/#{url}/issues"
  when :b     then "http://github.com/#{url}/issues/new"
  when :o     then "http://github.com/#{url}"
  else 
    "http://github.com/#{url}/tree/#{branch}"
  end
end

if !command
  puts %Q{
    USAGE:

      github command


    COMMANDS:
      
      o     open project
      pr    new pull request
      p     pull requests
      i     issues
      b     branches
  }
else
  bash "open '#{url_for_command(command)}'"
end

